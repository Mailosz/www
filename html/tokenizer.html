<!DOCTYPE html>
<html>
    <head>
        <title>Koloryzowanie składni</title>
        <meta charset="UTF-8">

        <style>
            .token:hover{
                background-color: rgba(127,127,127,0.3);
            }

            code {
                display: block;
                white-space: pre;
            }
        </style>
        <link rel="stylesheet" href="../css/langs/css-lang.css">
    </head>
    <body>
        <script type="module">
            import {StringTokenizer, StringTokenizerLanguage, StringTokenizerLanguageService } from "../js/tokenizer/StringTokenizer.js";

            async function colorizeAll() {

                StringTokenizerLanguageService.parseOptions.stricterParse = true;

                let language = await StringTokenizerLanguageService.getLanguageAsync("../js/tokenizer/css.json");

                let elems = document.getElementsByClassName("script");

                for (let el of elems){
                    colorizeTextContent(el, language);
                }
            }

            function colorizeTextContent(element, language) {
                let text = element.textContent.split('\n');
                element.textContent = "";
                console.time("Tokenizing time");

                let tokenizer = new StringTokenizer(language, null, {returnEmptyTokens: true});
                let linesOfTokens = [];
                for (const line of text) {
                    tokenizer.resetText(line + "\n");

                    const currentLine = [];
                    while (!tokenizer.isFinished()) {
                        
                        let token = tokenizer.getNextToken();
                        const context = tokenizer.getContext();
                        const values = {};
                        for (const name in context.values) {
                            values[name] = context.values[name];
                        }
                        for (const name in context.lists) {
                            values[name] = values[name] + "   " + context.lists[name].join(", ");
                        }
                        token.values = values;
                        currentLine.push(token);

                    }
                    linesOfTokens.push(currentLine);
                    
                }
                console.timeEnd("Tokenizing time");


                for (const line of linesOfTokens) {
                    const lineElement = document.createElement("div");

                    for (const token of line) {
                        const span = document.createElement("span");
                        span.textContent = token.text;
                        span.classList.add("token");
                        if (token.data && token.data.color) {
                            span.style.color = token.data.color;
                        }
                        if (token.startData && token.startData.error) {
                            span.style.textDecoration = "1px wavy red underline";
                        }
                        const data = {...token.data, ...token.beforeData, ...token.afterData};
                        if (token.data && data.class) {
                            span.classList.add(data.class);
                        } else {
                            span.classList.add(token.state);
                        }
                        span.title = token.state + "\n";

                        const tokenValues = token.values;
                        if (Object.values(tokenValues).length > 0) {
                            span.title += "\nValues:\n";
                            for (const d in tokenValues) {
                                span.title += d + ": " + tokenValues[d] + "\n";
                            }
                        }

                        if (token.beginData && Object.values(token.beginData).length > 0) {
                            span.title += "\nBegin data:\n";
                            for (const d in token.beginData) {
                                span.title += d + ": " + token.beginData[d] + "\n";
                            }
                        }

                        if (Object.values(token.data).length > 0) {
                            span.title += "\nData:\n";
                            for (const d in token.data) {
                                span.title += d + ": " + token.data[d] + "\n";
                            }
                        }

                        if (Object.values(token.afterData).length > 0) {
                            span.title += "\nAfter data:\n";
                            for (const d in token.afterData) {
                                span.title += d + ": " + token.afterData[d] + "\n";
                            }
                        }
                        lineElement.appendChild(span);
                    }
                    element.appendChild(lineElement);
                }
            }
            document.body.onload = ()=>colorizeAll();
        </script>
        <!-- contenteditable="true" onkeyup="change(this);" -->
        <code class="script" >
form {
    display: flex;
    flex-direction: column;
    gap: 0.5em 1em;
}

form::before {
    content: "{} : \" ' ; & < > / \\ ; ";
}


label {
    display: flex;
    flex-direction: column;
}


@media (min-width: 400px) {
    form {
        display: grid;
        grid-template-columns: fit-content(30%) 1fr;
    }

    :is(form, fieldset) > label:has(input, select, textarea, button) {
        grid-column-end: -1;
        display: grid;
        grid-template-columns: subgrid;
        justify-content: right;
        text-align: right;
    }

    form>fieldset, form>div {
        grid-column: 1 / -1;
        display: grid;
        grid-template-columns: subgrid; 
    }

}

:is(form, fieldset) > label {
    grid-column-start: 1;
    justify-self: right;
}



:is(form, fieldset) > label:is(input, select, textarea, button) {
    text-align: left;
}

:is(form, form>*, fieldset, fieldset>*)>:is(input, select, textarea, button) {
    grid-column-start: 2;
    grid-column-end: -1;
}

:is(form, form>*, fieldset, fieldset>*)>label:has(>input[type=checkbox], >input[type=radio]) {
    display: block;
    justify-self: left;
    grid-column-start: 2;
}


form>fieldset {
    gap: inherit;   
}


:is(form, fieldset) > :is(h1, h2, h3, h4, h5, h6, hr) {
    grid-column: 1 / -1;
}
            

:focus-visible {
    outline-offset: 2px;
    outline-width: 2px;
    outline-color: invert;
    outline-style: dashed;
}

/* BUTTONS */

.button, button, input[type=button], input[type=submit], input[type=reset], ::file-selector-button {
    display: inline-block;
    background-color: var(--button-background, #eee);
    border: var(--border-width) solid var(--border-color, #666);
    border-radius: var(--border-radius);
    padding: 0.25em 0.5em;
    cursor: pointer;
    text-decoration: none;
    color: var(--text-color, black);
}

    .button:hover, button:hover, 
    input[type=button]:hover, 
    input[type=submit]:hover, 
    input[type=reset]:hover, 
    ::file-selector-button:hover,
    input[type=radio]:enabled:hover,input[type=checkbox]:enabled:hover {
        filter: brightness(1.1);
    }

    .button:active, 
    button:active, 
    input[type=button]:active, 
    input[type=submit]:active, 
    input[type=reset]:active, 
    ::file-selector-button:active,
    input[type=radio]:enabled:active,input[type=checkbox]:enabled:active {
        filter: brightness(0.9);
    }

    .button:disabled, 
    button:disabled, 
    input[type=button]:disabled, 
    input[type=submit]:disabled, 
    input[type=reset]:disabled, 
    input:disabled, 
    textarea:disabled,
    select:disabled,
    :disabled::file-selector-button {
        filter: saturate(0.5) brightness(1.5) contrast(0.7);
        cursor: inherit;
    }

    

    .button:state(checked) {
        border: var(--border-width, 2px) solid var(--strong-accent-color, green);
        background-color: var(--weak-accent-color, #afa);
    }

/* arranges buttons in a single toolbar */
.toolbar, .horizontal-toolbar {
    display: inline-flex;
    justify-content: start;
    align-items: stretch;
    vertical-align: middle;
    gap: 0;
}

    :is(.toolbar, .horizontal-toolbar)>:is(ox-button):not(:first-child) {
        border-left: none;
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
    }

    :is(.toolbar, .horizontal-toolbar)>:is(ox-button):not(:last-child) {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
    }

.vertical-toolbar {
    display: inline-flex;
    flex-direction: column;
    justify-content: start;
    align-items: stretch;
    vertical-align: middle;
    gap: 0;
}

    .vertical-toolbar>:is(ox-button):not(:first-child) {
        border-top: none;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
    }

    .vertical-toolbar>:is(ox-button):not(:last-child) {
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
    }

/* INPUTS */

input {
    accent-color: var(--accent-color, inherit);
}

input:indeterminate {
    accent-color: gray;
}

input[type=checkbox], input[type=radio] {
    width: 1.5em;
    height: 1.5em;
    margin: 0.2em;
    vertical-align: text-bottom;
    transform: translateY(0.25em);
}

input:is(:not([type]),[type=text],[type=number],[type=password],[type=date],[type=datetime],[type=datetime-local],[type=month],[type=week],[type=tel],[type=time],[type=url],[type=email],[type=search]) , 
textarea,
select {
    border: 2px solid var(--border-color, #666);
    border-radius: var(--border-radius);
    padding: 0.25em 0.5em;
}

input:is(:not([type]),[type=text],[type=number],[type=password],[type=date],[type=datetime],[type=datetime-local],[type=month],[type=week],[type=tel],[type=time],[type=url],[type=email],[type=search]):focus, 
textarea:focus, 
select:focus {
    border-color: var(--accent-color, cornflowerblue);
    box-shadow: 0 0 10px rgba(127,127,127,0.5);
    outline: none;
}   

input[type=radio], input[type=checkbox] {
    background-color: white;
}

input[type=radio] {
    appearance: none;
    border-radius: 100%;
    border: 2px solid var(--border-color, #666);
    width: 1.5em;
    height: 1.5em;
    display: inline-block;
}

input[type=radio]::before {
    content: '';
    display: block;
    width: calc(100% - 4px);
    height: calc(100% - 4px);
    margin: 2px;
    background-color: var(--accent-color);
    border-radius: 100%;
    border: none;
    transform: scale(0);
    transition: cubic-bezier(0.5, 2, 0.65, 0.8) transform 200ms;
}

input[type=checkbox] {
    appearance: none;
    border-radius: var(--border-radius);
    border: 2px solid var(--border-color, #666);
    width: 1.5em;
    height: 1.5em;
    display: inline-block;
}

input[type=radio]:checked::before {
    transform: scale(1);
}

input[type=checkbox]::before {
    font-size: 0.75em;
    padding: 0;
    text-align: center;
    content: '✓';
    display: block;
    width: calc(100% - 4px);
    height: calc(100% - 4px);
    margin: 2px;
    background-color: var(--accent-color);
    border-radius: 1px;
    border: none;
    transform: scale(0);
    transition: cubic-bezier(0.5, 2, 0.65, 0.8) transform 200ms;
}

input[type=checkbox]:checked::before {
    transform: scale(1);
}

input[type=checkbox]:indeterminate::before {
    content: '?';
    transform: scale(1);
    color: white;
    background-color: gray;
}

input[type=radio]:disabled::before, input[type=checkbox]:disabled::before {
    background-color: #666;
    color: white;
}

/* FIELDSET */

fieldset {
    border-radius: var(--border-radius);
    border: none;;
    background-color: #f8f8f8;
    box-shadow: 0 2px 10px rgba(127,127,127,0.4);
}

/* SELECT */

select {
    appearance: base-select;
}

select[multiple] {
    padding: 0.25em 0;
}

::picker(select) {
    appearance: base-select;
    background-color: #f8f8f8;
    box-shadow: 0 2px 10px rgba(0,0,0,0.4);
    padding: 0;
    border-radius: var(--border-radius);
    border: 2px solid var(--border-color, #666);
}
select option {
    padding: 0.25em 0.5em;
}

select option:checked {
    background-color: var(--weaker-accent-color, cornflowerblue);
    color: black;
}


/* SEAMLESS */

ox-button.seamless {
    background-color: transparent;
    border: none;
    border-radius: 0;
}
ox-button.seamless:state(checked) {
    background-color: var(--weak-accent-color, lightblue);
}

ox-button.seamless:hover,
ox-button.seamless:active {
    background-color: var(--weaker-accent-color, lightblue);
}

/* PROGRESS BAR */

/* progress {
    box-sizing: border-box;
    background-color: rgba(from #aaa r g b / 0.5);
    accent-color: green;
    color: blueviolet;
    height: 20px;
    border: 2px solid #666;
    padding: 1px;
    border-radius: 4px;
    backdrop-filter: blur(2px);
}

progress::-moz-progress-bar {
    background-color: var(--accent-color, cornflowerblue);
    filter: blur(2px);
}

::-webkit-progress-bar {
    background-color: rgba(from #aaa r g b / 0.5);
}

::-webkit-progress-inner-element {
    background-color: none;
}

::-webkit-progress-value {
    background-color: var(--accent-color, cornflowerblue);
    filter: blur(2px);
}

@keyframes progressbar-indeterminate {
    0% {opacity: 1;}
    100% {opacity: 0;}
}



progress:indeterminate::-webkit-progress-bar {
    background: var(--accent-color, cornflowerblue);
     animation: 1s progressbar-indeterminate linear infinite alternate;
}

progress:indeterminate::-moz-progress-bar  {
    background: linear-gradient(to right, var(--accent-color, cornflowerblue) 0%, rgba(from var(--accent-color, cornflowerblue) r g b / 0.2) 50%, var(--accent-color, cornflowerblue) 100%);
    background-size: 100%;
    background-position: 50% 0% !important;
    animation: 1s progressbar-indeterminate linear infinite alternate;
} */
        </code>


        
    </body>
</html>